$OutputFile = Join-Path -Path $env:USERPROFILE -ChildPath "Desktop\wifi_passwords.txt"; (netsh wlan show profiles) | Select-String "\:(.+)$" | ForEach-Object { $name = $_.Matches.Groups[1].Value.Trim(); $_ } | ForEach-Object { (netsh wlan show profile name="$name" key=clear) } | Select-String "Key Content\W+\:(.+)$" | ForEach-Object { $pass = $_.Matches.Groups[1].Value.Trim(); "$name |---| $pass" } | Out-File -FilePath $OutputFile
